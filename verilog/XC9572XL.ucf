# P22 = VCC (fixed)
NET "nRD"   LOC = "P23" | IOSTANDARD = TTL;
NET "nWR"   LOC = "P24" | IOSTANDARD = TTL;
NET "nM1"   LOC = "P25" | IOSTANDARD = TTL;# ============================================================================
# XC9572XL-VQ64 User Constraints File (UCF)
# ZX Spectrum + Timex FDD Interface with Clock Generation
# ACTUAL ADDRESS SET FROM ORIGINAL GAL CHIPS
# ============================================================================
#
# Pin assignment strategy for VQ64:
#   - North side (P1-P16):   Clock + ZX address bits + Control
#   - East side (P17-P32):   ZX Data bus
#   - South side (P33-P48):  FDD Data bus + Control
#   - West side (P49-P64):   Clock outputs, Chip selects
#
# Address lines used: A2-A15 (14 pins) - matching original GAL chips
# Address lines NOT connected: A0, A1 (not used in original GAL designs)
#
# JTAG pins are automatically reserved:
#   P12 = TCK
#   P13 = TMS
#   P14 = TDI
#   P42 = TDO
#
# Power pins (fixed):
#   P22, P43, P64 = VCC
#   P11, P32, P53 = GND
#
# Total I/O used: 40 pins
# VQ64: 12 spare pins available
# TQ44: Does not fit (need 40, have 36)
#
# ============================================================================

# ============================================================================
# Clock Input
# ============================================================================

NET "CLK_16MHZ" LOC = "P1" | IOSTANDARD = LVCMOS33;

# ============================================================================
# ZX Spectrum Address Bus (14 pins - actual GAL chip connections)
# A0, A1 not connected (not used in original GAL designs)
# ============================================================================

NET "A2"  LOC = "P2"  | IOSTANDARD = TTL;
NET "A3"  LOC = "P3"  | IOSTANDARD = TTL;
NET "A4"  LOC = "P4"  | IOSTANDARD = TTL;
NET "A5"  LOC = "P5"  | IOSTANDARD = TTL;
NET "A6"  LOC = "P6"  | IOSTANDARD = TTL;
NET "A7"  LOC = "P7"  | IOSTANDARD = TTL;
NET "A8"  LOC = "P8"  | IOSTANDARD = TTL;
NET "A9"  LOC = "P9"  | IOSTANDARD = TTL;
NET "A10" LOC = "P10" | IOSTANDARD = TTL;
# P11 = GND (fixed)
# P12 = TCK (JTAG)
# P13 = TMS (JTAG)
# P14 = TDI (JTAG)
NET "A11" LOC = "P15" | IOSTANDARD = TTL;
NET "A12" LOC = "P16" | IOSTANDARD = TTL;
NET "A13" LOC = "P17" | IOSTANDARD = TTL;
NET "A14" LOC = "P18" | IOSTANDARD = TTL;
NET "A15" LOC = "P19" | IOSTANDARD = TTL;

# Address lines NOT connected (not used by original GAL chips):
# A0, A1

# ============================================================================
# ZX Spectrum Control Signals (5 pins)
# ============================================================================

NET "nIORQ" LOC = "P20" | IOSTANDARD = TTL;
NET "nMREQ" LOC = "P21" | IOSTANDARD = TTL;

# ============================================================================
# ZX Spectrum Data Bus (6 pins used: D0, D1, D4, D5, D6, D7)
# Bidirectional signals
# ============================================================================

NET "D0"    LOC = "P26" | IOSTANDARD = TTL;
NET "D1"    LOC = "P27" | IOSTANDARD = TTL;
NET "D4"    LOC = "P28" | IOSTANDARD = TTL;
NET "D5"    LOC = "P29" | IOSTANDARD = TTL;
NET "D6"    LOC = "P30" | IOSTANDARD = TTL;
NET "D7"    LOC = "P31" | IOSTANDARD = TTL;

# ============================================================================
# FDD Z80 Data Bus (6 pins used: D0, D1, D4, D5, D6, D7)
# Bidirectional signals
# ============================================================================

# P32 = GND (fixed)
NET "FDD_D0" LOC = "P33" | IOSTANDARD = TTL;
NET "FDD_D1" LOC = "P34" | IOSTANDARD = TTL;
NET "FDD_D4" LOC = "P35" | IOSTANDARD = TTL;
NET "FDD_D5" LOC = "P36" | IOSTANDARD = TTL;
NET "FDD_D6" LOC = "P37" | IOSTANDARD = TTL;
NET "FDD_D7" LOC = "P38" | IOSTANDARD = TTL;

# ============================================================================
# FDD Control Signals (2 pins)
# ============================================================================

NET "nTIIN"  LOC = "P39" | IOSTANDARD = TTL;
NET "nTIOUT" LOC = "P40" | IOSTANDARD = TTL;

# ============================================================================
# WD1770 FDC Signal (1 pin)
# ============================================================================

NET "WD1770_DRQ" LOC = "P41" | IOSTANDARD = TTL;

# ============================================================================
# Clock Outputs (2 pins)
# ============================================================================

# P42 = TDO (JTAG)
# P43 = VCC (fixed)
NET "CLK_8MHZ" LOC = "P44" | IOSTANDARD = LVCMOS33 | SLEW = FAST;
NET "CLK_4MHZ" LOC = "P45" | IOSTANDARD = LVCMOS33 | SLEW = FAST;

# ============================================================================
# Chip Select Outputs (3 pins)
# ============================================================================

NET "nZX_ROMCS" LOC = "P46" | IOSTANDARD = TTL;
NET "nROM_CS"   LOC = "P47" | IOSTANDARD = TTL;
NET "nRAM_CS"   LOC = "P48" | IOSTANDARD = TTL;

# ============================================================================
# Spare Pins Available for Future Expansion
# ============================================================================
# P49-P52, P54-P63 (12 spare I/O pins on VQ64)
# P53 = GND (fixed)
# P64 = VCC (fixed)

# ============================================================================
# Global Constraints
# ============================================================================

# Clock timing constraint for 16MHz input
NET "CLK_16MHZ" TNM_NET = "CLK_16MHZ";
TIMESPEC "TS_CLK_16MHZ" = PERIOD "CLK_16MHZ" 62.5 ns HIGH 50%;

# ============================================================================
# Pin Assignment Summary
# ============================================================================
#
# ZX Spectrum Bus:
#   - Address: P2-P10, P15-P19 (14 pins - actual from GAL chips)
#     * Connected: A2-A15
#     * NOT connected: A0, A1 (not used in original GAL designs)
#   - Control: P20-P21, P23-P25 (5 pins)
#   - Data:    P26-P31 (6 pins)
#   
# FDD System:
#   - Data:    P33-P38 (6 pins)
#   - Control: P39-P40 (2 pins)
#   - WD1770:  P41 (1 pin)
#
# Clocks:
#   - Input:   P1 (16MHz)
#   - Outputs: P44 (8MHz), P45 (4MHz)
#
# Chip Selects:
#   - P46, P47, P48 (3 pins)
#
# Total used: 40 I/O pins
# Spare pins: 12 pins (VQ64)
#
# ============================================================================
#
# CONSEQUENCES OF MISSING A0, A1:
# ================================
#
# 1. Page-in trigger (gal23_o13):
#    - Original: checks A0, A1, A4-A8, A11-A12
#    - Without A0, A1: will trigger on addresses 0x0000, 0x0001, 0x0002, 0x0003
#      and 0x0008, 0x0009, 0x000A, 0x000B (4x more addresses)
#
# 2. I/O port decoding (gal23_o12, gal23_o19):
#    - Original: port address requires A0=1, A1=1
#    - Without A0, A1: will respond to 4 I/O port addresses instead of 1
#      (ports 0x2C, 0x2D, 0x2E, 0x2F instead of just 0x2F)
#
# 3. ROM/RAM operation:
#    - Not affected - A0, A1 connect directly to ROM/RAM chips
#
# RECOMMENDATION: If the ROM software always uses the correct addresses
# (0x0000 or 0x0008 for page-in, and 0x2F for I/O port), the missing
# address decode will not cause issues. The extra aliases will just be
# ignored.
#
# ============================================================================

<svg viewBox="0 0 1200 900" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="600" y="30" font-size="24" font-weight="bold" text-anchor="middle" fill="#000">
    WD1770 Drop-in Replacement with SD Card
  </text>
  <text x="600" y="55" font-size="14" text-anchor="middle" fill="#666">
    STM32F411 Black Pill - No level shifters needed (5V tolerant inputs)
  </text>
  
  <!-- STM32F411 Black Pill -->
  <g id="stm32">
    <rect x="400" y="100" width="180" height="600" fill="#2c3e50" stroke="#000" stroke-width="2"/>
    <text x="490" y="125" font-size="16" font-weight="bold" text-anchor="middle" fill="#fff">
      STM32F411
    </text>
    <text x="490" y="145" font-size="12" text-anchor="middle" fill="#fff">
      Black Pill
    </text>
    
    <!-- Left side pins -->
    <g id="left-pins">
      <!-- GND -->
      <circle cx="400" cy="170" r="3" fill="#ffd700"/>
      <text x="390" y="174" font-size="10" text-anchor="end" fill="#000">GND</text>
      
      <!-- 3.3V -->
      <circle cx="400" cy="190" r="3" fill="#ff0000"/>
      <text x="390" y="194" font-size="10" text-anchor="end" fill="#000">3.3V</text>
      
      <!-- 5V -->
      <circle cx="400" cy="210" r="3" fill="#ff0000"/>
      <text x="390" y="214" font-size="10" text-anchor="end" fill="#000">5V</text>
      
      <!-- PB12 - STEP -->
      <circle cx="400" cy="250" r="3" fill="#00ff00"/>
      <text x="390" y="254" font-size="10" text-anchor="end" fill="#000">PB12</text>
      <text x="385" y="264" font-size="8" text-anchor="end" fill="#666">STEP</text>
      
      <!-- PB13 - DIRC -->
      <circle cx="400" cy="280" r="3" fill="#00ff00"/>
      <text x="390" y="284" font-size="10" text-anchor="end" fill="#000">PB13</text>
      <text x="385" y="294" font-size="8" text-anchor="end" fill="#666">DIRC</text>
      
      <!-- PB14 - TR00 -->
      <circle cx="400" cy="310" r="3" fill="#00ff00"/>
      <text x="390" y="314" font-size="10" text-anchor="end" fill="#000">PB14</text>
      <text x="385" y="324" font-size="8" text-anchor="end" fill="#666">TR00</text>
      
      <!-- PB15 - IP -->
      <circle cx="400" cy="340" r="3" fill="#00ff00"/>
      <text x="390" y="344" font-size="10" text-anchor="end" fill="#000">PB15</text>
      <text x="385" y="354" font-size="8" text-anchor="end" fill="#666">INDEX</text>
      
      <!-- PA8 - A0 -->
      <circle cx="400" cy="380" r="3" fill="#ffff00"/>
      <text x="390" y="384" font-size="10" text-anchor="end" fill="#000">PA8</text>
      <text x="385" y="394" font-size="8" text-anchor="end" fill="#666">A0</text>
      
      <!-- PA9 - A1 -->
      <circle cx="400" cy="410" r="3" fill="#ffff00"/>
      <text x="390" y="414" font-size="10" text-anchor="end" fill="#000">PA9</text>
      <text x="385" y="424" font-size="8" text-anchor="end" fill="#666">A1</text>
      
      <!-- PA10 - CS -->
      <circle cx="400" cy="440" r="3" fill="#ffff00"/>
      <text x="390" y="444" font-size="10" text-anchor="end" fill="#000">PA10</text>
      <text x="385" y="454" font-size="8" text-anchor="end" fill="#666">CS</text>
      
      <!-- PA15 - INTRQ -->
      <circle cx="400" cy="470" r="3" fill="#00ff00"/>
      <text x="390" y="474" font-size="10" text-anchor="end" fill="#000">PA15</text>
      <text x="385" y="484" font-size="8" text-anchor="end" fill="#666">INTRQ</text>
      
      <!-- PB3 - unused in this design -->
      <circle cx="400" cy="500" r="3" fill="#ccc"/>
      <text x="390" y="504" font-size="10" text-anchor="end" fill="#000">PB3</text>
      
      <!-- PB4 - D0 -->
      <circle cx="400" cy="530" r="3" fill="#00ffff"/>
      <text x="390" y="534" font-size="10" text-anchor="end" fill="#000">PB4</text>
      <text x="385" y="544" font-size="8" text-anchor="end" fill="#666">D0</text>
      
      <!-- PB5 - D1 -->
      <circle cx="400" cy="560" r="3" fill="#00ffff"/>
      <text x="390" y="564" font-size="10" text-anchor="end" fill="#000">PB5</text>
      <text x="385" y="574" font-size="8" text-anchor="end" fill="#666">D1</text>
      
      <!-- PB6 - D2 -->
      <circle cx="400" cy="590" r="3" fill="#00ffff"/>
      <text x="390" y="594" font-size="10" text-anchor="end" fill="#000">PB6</text>
      <text x="385" y="604" font-size="8" text-anchor="end" fill="#666">D2</text>
      
      <!-- PB7 - D3 -->
      <circle cx="400" cy="620" r="3" fill="#00ffff"/>
      <text x="390" y="624" font-size="10" text-anchor="end" fill="#000">PB7</text>
      <text x="385" y="634" font-size="8" text-anchor="end" fill="#666">D3</text>
      
      <!-- PB8 - DRQ -->
      <circle cx="400" cy="650" r="3" fill="#00ff00"/>
      <text x="390" y="654" font-size="10" text-anchor="end" fill="#000">PB8</text>
      <text x="385" y="664" font-size="8" text-anchor="end" fill="#666">DRQ</text>
    </g>
    
    <!-- Right side pins -->
    <g id="right-pins">
      <!-- PB0 - D4 -->
      <circle cx="580" cy="170" r="3" fill="#00ffff"/>
      <text x="590" y="174" font-size="10" text-anchor="start" fill="#000">PB0</text>
      <text x="595" y="184" font-size="8" text-anchor="start" fill="#666">D4</text>
      
      <!-- PB1 - D5 -->
      <circle cx="580" cy="200" r="3" fill="#00ffff"/>
      <text x="590" y="204" font-size="10" text-anchor="start" fill="#000">PB1</text>
      <text x="595" y="214" font-size="8" text-anchor="start" fill="#666">D5</text>
      
      <!-- PB2 - D6 -->
      <circle cx="580" cy="230" r="3" fill="#00ffff"/>
      <text x="590" y="234" font-size="10" text-anchor="start" fill="#000">PB2</text>
      <text x="595" y="244" font-size="8" text-anchor="start" fill="#666">D6</text>
      
      <!-- PB10 - D7 -->
      <circle cx="580" cy="260" r="3" fill="#00ffff"/>
      <text x="590" y="264" font-size="10" text-anchor="start" fill="#000">PB10</text>
      <text x="595" y="274" font-size="8" text-anchor="start" fill="#666">D7</text>
      
      <!-- PA11 - RE -->
      <circle cx="580" cy="300" r="3" fill="#ffff00"/>
      <text x="590" y="304" font-size="10" text-anchor="start" fill="#000">PA11</text>
      <text x="595" y="314" font-size="8" text-anchor="start" fill="#666">RE</text>
      
      <!-- PA12 - WE -->
      <circle cx="580" cy="330" r="3" fill="#ffff00"/>
      <text x="590" y="334" font-size="10" text-anchor="start" fill="#000">PA12</text>
      <text x="595" y="344" font-size="8" text-anchor="start" fill="#666">WE</text>
      
      <!-- PB9 - DDEN -->
      <circle cx="580" cy="360" r="3" fill="#ffff00"/>
      <text x="590" y="364" font-size="10" text-anchor="start" fill="#000">PB9</text>
      <text x="595" y="374" font-size="8" text-anchor="start" fill="#666">DDEN</text>
      
      <!-- PC13 - LED -->
      <circle cx="580" cy="400" r="3" fill="#ff00ff"/>
      <text x="590" y="404" font-size="10" text-anchor="start" fill="#000">PC13</text>
      <text x="595" y="414" font-size="8" text-anchor="start" fill="#666">LED</text>
      
      <!-- PA4 - SD CS -->
      <circle cx="580" cy="450" r="3" fill="#ff8800"/>
      <text x="590" y="454" font-size="10" text-anchor="start" fill="#000">PA4</text>
      <text x="595" y="464" font-size="8" text-anchor="start" fill="#666">SD_CS</text>
      
      <!-- PA5 - SD SCK -->
      <circle cx="580" cy="480" r="3" fill="#ff8800"/>
      <text x="590" y="484" font-size="10" text-anchor="start" fill="#000">PA5</text>
      <text x="595" y="494" font-size="8" text-anchor="start" fill="#666">SD_SCK</text>
      
      <!-- PA6 - SD MISO -->
      <circle cx="580" cy="510" r="3" fill="#ff8800"/>
      <text x="590" y="514" font-size="10" text-anchor="start" fill="#000">PA6</text>
      <text x="595" y="524" font-size="8" text-anchor="start" fill="#666">SD_MISO</text>
      
      <!-- PA7 - SD MOSI -->
      <circle cx="580" cy="540" r="3" fill="#ff8800"/>
      <text x="590" y="544" font-size="10" text-anchor="start" fill="#000">PA7</text>
      <text x="595" y="554" font-size="8" text-anchor="start" fill="#666">SD_MOSI</text>
      
      <!-- PA0 - Rotary CLK -->
      <circle cx="580" cy="590" r="3" fill="#ff00ff"/>
      <text x="590" y="594" font-size="10" text-anchor="start" fill="#000">PA0</text>
      <text x="595" y="604" font-size="8" text-anchor="start" fill="#666">ROT_CLK</text>
      
      <!-- PA1 - Rotary DT -->
      <circle cx="580" cy="620" r="3" fill="#ff00ff"/>
      <text x="590" y="624" font-size="10" text-anchor="start" fill="#000">PA1</text>
      <text x="595" y="634" font-size="8" text-anchor="start" fill="#666">ROT_DT</text>
      
      <!-- PA2 - Rotary SW -->
      <circle cx="580" cy="650" r="3" fill="#ff00ff"/>
      <text x="590" y="654" font-size="10" text-anchor="start" fill="#000">PA2</text>
      <text x="595" y="664" font-size="8" text-anchor="start" fill="#666">ROT_SW</text>
    </g>
  </g>
  
  <!-- WD1770 Socket (left side) -->
  <g id="wd1770-socket">
    <rect x="50" y="250" width="120" height="340" fill="#1a1a1a" stroke="#000" stroke-width="2"/>
    <text x="110" y="275" font-size="14" font-weight="bold" text-anchor="middle" fill="#fff">
      WD1770
    </text>
    <text x="110" y="295" font-size="10" text-anchor="middle" fill="#fff">
      Socket
    </text>
    
    <!-- Pin labels -->
    <text x="60" y="325" font-size="9" fill="#fff">D0-D7</text>
    <text x="60" y="355" font-size="9" fill="#fff">A0-A1</text>
    <text x="60" y="385" font-size="9" fill="#fff">CS</text>
    <text x="60" y="415" font-size="9" fill="#fff">RE/WE</text>
    <text x="60" y="445" font-size="9" fill="#fff">INTRQ</text>
    <text x="60" y="475" font-size="9" fill="#fff">DRQ</text>
    <text x="60" y="505" font-size="9" fill="#fff">STEP</text>
    <text x="60" y="535" font-size="9" fill="#fff">DIRC</text>
    <text x="60" y="565" font-size="9" fill="#fff">TR00</text>
  </g>
  
  <!-- SD Card Module (right side) -->
  <g id="sd-card">
    <rect x="750" y="400" width="140" height="180" fill="#4CAF50" stroke="#000" stroke-width="2"/>
    <text x="820" y="425" font-size="14" font-weight="bold" text-anchor="middle" fill="#fff">
      SD Card
    </text>
    <text x="820" y="445" font-size="12" text-anchor="middle" fill="#fff">
      Module
    </text>
    
    <!-- Pins -->
    <circle cx="750" cy="480" r="3" fill="#fff"/>
    <text x="740" y="484" font-size="10" text-anchor="end" fill="#000">CS</text>
    
    <circle cx="750" cy="505" r="3" fill="#fff"/>
    <text x="740" y="509" font-size="10" text-anchor="end" fill="#000">SCK</text>
    
    <circle cx="750" cy="530" r="3" fill="#fff"/>
    <text x="740" y="534" font-size="10" text-anchor="end" fill="#000">MOSI</text>
    
    <circle cx="750" cy="555" r="3" fill="#fff"/>
    <text x="740" y="559" font-size="10" text-anchor="end" fill="#000">MISO</text>
    
    <circle cx="890" cy="480" r="3" fill="#fff"/>
    <text x="900" y="484" font-size="10" text-anchor="start" fill="#000">VCC</text>
    
    <circle cx="890" cy="505" r="3" fill="#fff"/>
    <text x="900" y="509" font-size="10" text-anchor="start" fill="#000">GND</text>
  </g>
  
  <!-- Rotary Encoder (bottom right) -->
  <g id="rotary">
    <rect x="750" y="620" width="140" height="120" fill="#FF9800" stroke="#000" stroke-width="2"/>
    <text x="820" y="645" font-size="14" font-weight="bold" text-anchor="middle" fill="#fff">
      Rotary
    </text>
    <text x="820" y="665" font-size="12" text-anchor="middle" fill="#fff">
      Encoder
    </text>
    
    <circle cx="750" cy="690" r="3" fill="#fff"/>
    <text x="740" y="694" font-size="10" text-anchor="end" fill="#000">CLK</text>
    
    <circle cx="750" cy="710" r="3" fill="#fff"/>
    <text x="740" y="714" font-size="10" text-anchor="end" fill="#000">DT</text>
    
    <circle cx="750" cy="730" r="3" fill="#fff"/>
    <text x="740" y="734" font-size="10" text-anchor="end" fill="#000">SW</text>
  </g>
  
  <!-- OLED Display (optional) -->
  <g id="oled">
    <rect x="750" y="200" width="140" height="140" fill="#2196F3" stroke="#000" stroke-width="2"/>
    <text x="820" y="225" font-size="14" font-weight="bold" text-anchor="middle" fill="#fff">
      OLED 0.96"
    </text>
    <text x="820" y="245" font-size="10" text-anchor="middle" fill="#fff">
      (Optional)
    </text>
    
    <circle cx="750" cy="280" r="3" fill="#fff"/>
    <text x="740" y="284" font-size="10" text-anchor="end" fill="#000">SDA</text>
    
    <circle cx="750" cy="305" r="3" fill="#fff"/>
    <text x="740" y="309" font-size="10" text-anchor="end" fill="#000">SCL</text>
    
    <circle cx="890" cy="280" r="3" fill="#fff"/>
    <text x="900" y="284" font-size="10" text-anchor="start" fill="#000">VCC</text>
    
    <circle cx="890" cy="305" r="3" fill="#fff"/>
    <text x="900" y="309" font-size="10" text-anchor="start" fill="#000">GND</text>
  </g>
  
  <!-- LED Indicator -->
  <g id="led">
    <circle cx="820" y="120" r="15" fill="#ff0000" stroke="#000" stroke-width="2"/>
    <text x="820" y="155" font-size="10" text-anchor="middle" fill="#000">Activity LED</text>
    <text x="820" y="170" font-size="8" text-anchor="middle" fill="#666">(with 330Ω R)</text>
  </g>
  
  <!-- Connection lines -->
  <!-- Data Bus -->
  <line x1="170" y1="320" x2="400" y2="530" stroke="#00ffff" stroke-width="2"/>
  <text x="285" y="410" font-size="10" fill="#00ffff">8-bit Data Bus</text>
  
  <!-- Address lines -->
  <line x1="170" y1="350" x2="400" y2="380" stroke="#ffff00" stroke-width="2"/>
  
  <!-- Control signals -->
  <line x1="170" y1="380" x2="400" y2="440" stroke="#ffff00" stroke-width="2"/>
  <line x1="170" y1="410" x2="580" y2="300" stroke="#ffff00" stroke-width="2"/>
  
  <!-- FDC signals -->
  <line x1="170" y1="440" x2="400" y2="470" stroke="#00ff00" stroke-width="2"/>
  <line x1="170" y1="470" x2="400" y2="650" stroke="#00ff00" stroke-width="2"/>
  <line x1="170" y1="500" x2="400" y2="250" stroke="#00ff00" stroke-width="2"/>
  <line x1="170" y1="530" x2="400" y2="280" stroke="#00ff00" stroke-width="2"/>
  <line x1="170" y1="560" x2="400" y2="310" stroke="#00ff00" stroke-width="2"/>
  
  <!-- SD Card connections -->
  <line x1="580" y1="450" x2="750" y2="480" stroke="#ff8800" stroke-width="2"/>
  <line x1="580" y1="480" x2="750" y2="505" stroke="#ff8800" stroke-width="2"/>
  <line x1="580" y1="510" x2="750" y2="555" stroke="#ff8800" stroke-width="2"/>
  <line x1="580" y1="540" x2="750" y2="530" stroke="#ff8800" stroke-width="2"/>
  
  <!-- Rotary encoder connections -->
  <line x1="580" y1="590" x2="750" y2="690" stroke="#ff00ff" stroke-width="2"/>
  <line x1="580" y1="620" x2="750" y2="710" stroke="#ff00ff" stroke-width="2"/>
  <line x1="580" y1="650" x2="750" y2="730" stroke="#ff00ff" stroke-width="2"/>
  
  <!-- LED connection -->
  <line x1="580" y1="400" x2="805" y2="120" stroke="#ff0000" stroke-width="2"/>
  
  <!-- Power connections -->
  <line x1="400" y1="190" x2="890" y2="280" stroke="#ff0000" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="400" y1="190" x2="890" y2="480" stroke="#ff0000" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="400" y1="170" x2="890" y2="305" stroke="#000" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="400" y1="170" x2="890" y2="505" stroke="#000" stroke-width="2" stroke-dasharray="5,5"/>
  
  <!-- Legend -->
  <g id="legend">
    <text x="50" y="760" font-size="14" font-weight="bold" fill="#000">Signal Legend:</text>
    
    <line x1="50" y1="780" x2="80" y2="780" stroke="#00ffff" stroke-width="3"/>
    <text x="90" y="784" font-size="11" fill="#000">Data Bus (8-bit bidirectional)</text>
    
    <line x1="50" y1="800" x2="80" y2="800" stroke="#ffff00" stroke-width="3"/>
    <text x="90" y="804" font-size="11" fill="#000">Address & Control (from CPU)</text>
    
    <line x1="50" y1="820" x2="80" y2="820" stroke="#00ff00" stroke-width="3"/>
    <text x="90" y="824" font-size="11" fill="#000">FDC Interface Signals</text>
    
    <line x1="300" y1="780" x2="330" y2="780" stroke="#ff8800" stroke-width="3"/>
    <text x="340" y="784" font-size="11" fill="#000">SD Card SPI</text>
    
    <line x1="300" y1="800" x2="330" y2="800" stroke="#ff00ff" stroke-width="3"/>
    <text x="340" y="804" font-size="11" fill="#000">User Interface (Optional)</text>
    
    <line x1="300" y1="820" x2="330" y2="820" stroke="#ff0000" stroke-width="3" stroke-dasharray="5,5"/>
    <text x="340" y="824" font-size="11" fill="#000">Power (3.3V)</text>
  </g>
  
  <!-- Notes -->
  <g id="notes">
    <text x="550" y="760" font-size="14" font-weight="bold" fill="#000">Notes:</text>
    <text x="550" y="780" font-size="10" fill="#000">• STM32F411 inputs are 5V tolerant - no level shifters needed</text>
    <text x="550" y="795" font-size="10" fill="#000">• Add 10kΩ pull-up resistors on A0, A1, CS, RE, WE</text>
    <text x="550" y="810" font-size="10" fill="#000">• Use 100nF decoupling caps on all power pins</text>
    <text x="550" y="825" font-size="10" fill="#000">• Activity LED needs 330Ω current limiting resistor</text>
    <text x="550" y="840" font-size="10" fill="#000">• OLED and Rotary Encoder are optional for image selection</text>
    <text x="550" y="855" font-size="10" fill="#000">• Format SD card as FAT32, place .DSK/.ST/.IMG files in root</text>
  </g>
  
  <!-- Board outline suggestion -->
  <rect x="380" y="85" width="220" height="630" fill="none" stroke="#0000ff" stroke-width="2" stroke-dasharray="10,5"/>
  <text x="490" y="80" font-size="10" text-anchor="middle" fill="#0000ff">Suggested PCB outline</text>
</svg>